# Blade Master (Awem)

set MEMORY_FILE10 binary "\x55\x8b\xec\x83\xec\x3c\x53\x89\x4d\xdc\xc7\x45\xfc\x08\x00\x00\x00\x8b\x45\x08\x89\x45\xec\x8b\x45\xec\x66\x8b\x00\x66\x89\x45\xea\x8b\x45\xec\x40\x40\x89\x45\xec\x8b\x45\xec\x66\x8b\x00\x66\x89\x45\xe8\x8b\x45\xec\x40\x40\x89\x45\xec\x8b\x45\xec\x66\x8b\x00\x66\x89\x45\xe2\x8b\x45\xec\x40\x40\x89\x45\xec\x8b\x45\xec\x66\x8b\x00\x66\x89\x45\xe0\x0f\xb7\x45\xea\xc1\xf8\x08\x0f\xb7\x4d\xea\xc1\xe1\x08\x0b\xc1\x66\x89\x45\xea\x0f\xb7\x45\xe8\xc1\xf8\x08\x0f\xb7\x4d\xe8\xc1\xe1\x08\x0b\xc1\x66\x89\x45\xe8\x0f\xb7\x45\xe2\xc1\xf8\x08\x0f\xb7\x4d\xe2\xc1\xe1\x08\x0b\xc1\x66\x89\x45\xe2\x0f\xb7\x45\xe0\xc1\xf8\x08\x0f\xb7\x4d\xe0\xc1\xe1\x08\x0b\xc1\x66\x89\x45\xe0\x8b\x45\x10\x66\x8b\x00\x66\x89\x45\xf4\x0f\xb7\x45\xf4\x8b\x4d\x10\x41\x41\x89\x4d\x10\x85\xc0\x0f\x84\x81\x00\x00\x00\x0f\xb7\x45\xea\x25\xff\xff\x00\x00\x66\x89\x45\xea\x0f\xb7\x45\xea\x85\xc0\x74\x4d\x0f\xb7\x45\xea\x0f\xb7\x4d\xf4\x0f\xaf\xc1\x89\x45\xe4\x8b\x45\xe4\x25\xff\xff\x00\x00\x66\x89\x45\xea\x8b\x45\xe4\xc1\xe8\x10\x66\x89\x45\xf4\x0f\xb7\x45\xea\x0f\xb7\x4d\xf4\x2b\xc1\x0f\xb7\x4d\xea\x0f\xb7\x55\xf4\x33\xdb\x3b\xca\x0f\x9c\xc3\x03\xc3\x66\x89\x45\xea\x66\x8b\x45\xea\x66\x89\x45\xda\xeb\x15\x0f\xb7\x45\xf4\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xea\x66\x8b\x45\xea\x66\x89\x45\xda\x66\x8b\x45\xda\x66\x89\x45\xd8\xeb\x15\x0f\xb7\x45\xea\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xea\x66\x8b\x45\xea\x66\x89\x45\xd8\x8b\x45\x10\x0f\xb7\x00\x0f\xb7\x4d\xe8\x03\xc8\x66\x89\x4d\xe8\x8b\x45\x10\x40\x40\x89\x45\x10\x8b\x45\x10\x0f\xb7\x00\x0f\xb7\x4d\xe2\x03\xc8\x66\x89\x4d\xe2\x8b\x45\x10\x40\x40\x89\x45\x10\x8b\x45\x10\x66\x8b\x00\x66\x89\x45\xf4\x0f\xb7\x45\xf4\x8b\x4d\x10\x41\x41\x89\x4d\x10\x85\xc0\x0f\x84\x81\x00\x00\x00\x0f\xb7\x45\xe0\x25\xff\xff\x00\x00\x66\x89\x45\xe0\x0f\xb7\x45\xe0\x85\xc0\x74\x4d\x0f\xb7\x45\xe0\x0f\xb7\x4d\xf4\x0f\xaf\xc1\x89\x45\xe4\x8b\x45\xe4\x25\xff\xff\x00\x00\x66\x89\x45\xe0\x8b\x45\xe4\xc1\xe8\x10\x66\x89\x45\xf4\x0f\xb7\x45\xe0\x0f\xb7\x4d\xf4\x2b\xc1\x0f\xb7\x4d\xe0\x0f\xb7\x55\xf4\x33\xdb\x3b\xca\x0f\x9c\xc3\x03\xc3\x66\x89\x45\xe0\x66\x8b\x45\xe0\x66\x89\x45\xd6\xeb\x15\x0f\xb7\x45\xf4\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xe0\x66\x8b\x45\xe0\x66\x89\x45\xd6\x66\x8b\x45\xd6\x66\x89\x45\xd4\xeb\x15\x0f\xb7\x45\xe0\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xe0\x66\x8b\x45\xe0\x66\x89\x45\xd4\x66\x8b\x45\xe2\x66\x89\x45\xf2\x0f\xb7\x45\xea\x0f\xb7\x4d\xe2\x33\xc8\x66\x89\x4d\xe2\x8b\x45\x10\x66\x8b\x00\x66\x89\x45\xf4\x0f\xb7\x45\xf4\x8b\x4d\x10\x41\x41\x89\x4d\x10\x85\xc0\x0f\x84\x81\x00\x00\x00\x0f\xb7\x45\xe2\x25\xff\xff\x00\x00\x66\x89\x45\xe2\x0f\xb7\x45\xe2\x85\xc0\x74\x4d\x0f\xb7\x45\xe2\x0f\xb7\x4d\xf4\x0f\xaf\xc1\x89\x45\xe4\x8b\x45\xe4\x25\xff\xff\x00\x00\x66\x89\x45\xe2\x8b\x45\xe4\xc1\xe8\x10\x66\x89\x45\xf4\x0f\xb7\x45\xe2\x0f\xb7\x4d\xf4\x2b\xc1\x0f\xb7\x4d\xe2\x0f\xb7\x55\xf4\x33\xdb\x3b\xca\x0f\x9c\xc3\x03\xc3\x66\x89\x45\xe2\x66\x8b\x45\xe2\x66\x89\x45\xd2\xeb\x15\x0f\xb7\x45\xf4\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xe2\x66\x8b\x45\xe2\x66\x89\x45\xd2\x66\x8b\x45\xd2\x66\x89\x45\xd0\xeb\x15\x0f\xb7\x45\xe2\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xe2\x66\x8b\x45\xe2\x66\x89\x45\xd0\x66\x8b\x45\xe8\x66\x89\x45\xf6\x0f\xb7\x45\xe0\x0f\xb7\x4d\xe8\x33\xc8\x66\x89\x4d\xe8\x0f\xb7\x45\xe2\x0f\xb7\x4d\xe8\x03\xc8\x66\x89\x4d\xe8\x8b\x45\x10\x66\x8b\x00\x66\x89\x45\xf4\x0f\xb7\x45\xf4\x8b\x4d\x10\x41\x41\x89\x4d\x10\x85\xc0\x0f\x84\x81\x00\x00\x00\x0f\xb7\x45\xe8\x25\xff\xff\x00\x00\x66\x89\x45\xe8\x0f\xb7\x45\xe8\x85\xc0\x74\x4d\x0f\xb7\x45\xe8\x0f\xb7\x4d\xf4\x0f\xaf\xc1\x89\x45\xe4\x8b\x45\xe4\x25\xff\xff\x00\x00\x66\x89\x45\xe8\x8b\x45\xe4\xc1\xe8\x10\x66\x89\x45\xf4\x0f\xb7\x45\xe8\x0f\xb7\x4d\xf4\x2b\xc1\x0f\xb7\x4d\xe8\x0f\xb7\x55\xf4\x33\xdb\x3b\xca\x0f\x9c\xc3\x03\xc3\x66\x89\x45\xe8\x66\x8b\x45\xe8\x66\x89\x45\xce\xeb\x15\x0f\xb7\x45\xf4\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xe8\x66\x8b\x45\xe8\x66\x89\x45\xce\x66\x8b\x45\xce\x66\x89\x45\xcc\xeb\x15\x0f\xb7\x45\xe8\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xe8\x66\x8b\x45\xe8\x66\x89\x45\xcc\x0f\xb7\x45\xe8\x0f\xb7\x4d\xe2\x03\xc8\x66\x89\x4d\xe2\x0f\xb7\x45\xe8\x0f\xb7\x4d\xea\x33\xc8\x66\x89\x4d\xea\x0f\xb7\x45\xe2\x0f\xb7\x4d\xe0\x33\xc8\x66\x89\x4d\xe0\x0f\xb7\x45\xf2\x0f\xb7\x4d\xe8\x33\xc8\x66\x89\x4d\xe8\x0f\xb7\x45\xf6\x0f\xb7\x4d\xe2\x33\xc8\x66\x89\x4d\xe2\x8b\x45\xfc\x48\x89\x45\xfc\x83\x7d\xfc\x00\x0f\x85\x6f\xfc\xff\xff\x8b\x45\x10\x66\x8b\x00\x66\x89\x45\xf4\x0f\xb7\x45\xf4\x8b\x4d\x10\x41\x41\x89\x4d\x10\x85\xc0\x0f\x84\x81\x00\x00\x00\x0f\xb7\x45\xea\x25\xff\xff\x00\x00\x66\x89\x45\xea\x0f\xb7\x45\xea\x85\xc0\x74\x4d\x0f\xb7\x45\xea\x0f\xb7\x4d\xf4\x0f\xaf\xc1\x89\x45\xe4\x8b\x45\xe4\x25\xff\xff\x00\x00\x66\x89\x45\xea\x8b\x45\xe4\xc1\xe8\x10\x66\x89\x45\xf4\x0f\xb7\x45\xea\x0f\xb7\x4d\xf4\x2b\xc1\x0f\xb7\x4d\xea\x0f\xb7\x55\xf4\x33\xdb\x3b\xca\x0f\x9c\xc3\x03\xc3\x66\x89\x45\xea\x66\x8b\x45\xea\x66\x89\x45\xca\xeb\x15\x0f\xb7\x45\xf4\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xea\x66\x8b\x45\xea\x66\x89\x45\xca\x66\x8b\x45\xca\x66\x89\x45\xc8\xeb\x15\x0f\xb7\x45\xea\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xea\x66\x8b\x45\xea\x66\x89\x45\xc8\x8b\x45\x10\x0f\xb7\x00\x0f\xb7\x4d\xe2\x03\xc8\x66\x89\x4d\xe2\x8b\x45\x10\x40\x40\x89\x45\x10\x8b\x45\x10\x0f\xb7\x00\x0f\xb7\x4d\xe8\x03\xc8\x66\x89\x4d\xe8\x8b\x45\x10\x40\x40\x89\x45\x10\x8b\x45\x10\x66\x8b\x00\x66\x89\x45\xf4\x0f\xb7\x45\xf4\x85\xc0\x0f\x84\x81\x00\x00\x00\x0f\xb7\x45\xe0\x25\xff\xff\x00\x00\x66\x89\x45\xe0\x0f\xb7\x45\xe0\x85\xc0\x74\x4d\x0f\xb7\x45\xe0\x0f\xb7\x4d\xf4\x0f\xaf\xc1\x89\x45\xe4\x8b\x45\xe4\x25\xff\xff\x00\x00\x66\x89\x45\xe0\x8b\x45\xe4\xc1\xe8\x10\x66\x89\x45\xf4\x0f\xb7\x45\xe0\x0f\xb7\x4d\xf4\x2b\xc1\x0f\xb7\x4d\xe0\x0f\xb7\x55\xf4\x33\xdb\x3b\xca\x0f\x9c\xc3\x03\xc3\x66\x89\x45\xe0\x66\x8b\x45\xe0\x66\x89\x45\xc6\xeb\x15\x0f\xb7\x45\xf4\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xe0\x66\x8b\x45\xe0\x66\x89\x45\xc6\x66\x8b\x45\xc6\x66\x89\x45\xc4\xeb\x15\x0f\xb7\x45\xe0\x33\xc9\x41\x2b\xc8\x66\x89\x4d\xe0\x66\x8b\x45\xe0\x66\x89\x45\xc4\x8b\x45\x0c\x89\x45\xf8\x0f\xb7\x45\xea\xc1\xf8\x08\x0f\xb7\x4d\xea\xc1\xe1\x08\x0b\xc1\x8b\x4d\xf8\x66\x89\x01\x8b\x45\xf8\x40\x40\x89\x45\xf8\x0f\xb7\x45\xe2\xc1\xf8\x08\x0f\xb7\x4d\xe2\xc1\xe1\x08\x0b\xc1\x8b\x4d\xf8\x66\x89\x01\x8b\x45\xf8\x40\x40\x89\x45\xf8\x0f\xb7\x45\xe8\xc1\xf8\x08\x0f\xb7\x4d\xe8\xc1\xe1\x08\x0b\xc1\x8b\x4d\xf8\x66\x89\x01\x8b\x45\xf8\x40\x40\x89\x45\xf8\x0f\xb7\x45\xe0\xc1\xf8\x08\x0f\xb7\x4d\xe0\xc1\xe1\x08\x0b\xc1\x8b\x4d\xf8\x66\x89\x01\x5b\xc9\xc2\x0c\x00\x55\x8b\xec\x83\xec\x0c\x89\x4d\xf4\x8b\x45\x08\x89\x45\xfc\x83\x65\xf8\x00\xeb\x07\x8b\x45\xf8\x40\x89\x45\xf8\x8b\x45\xf8\x3b\x45\x0c\x7d\x20\x8b\x45\xf4\x83\xc0\x68\x50\xff\x75\xfc\xff\x75\xfc\x8b\x4d\xf4\xe8\x84\xf9\xff\xff\x8b\x45\xfc\x83\xc0\x08\x89\x45\xfc\xeb\xd1\xc9\xc2\x08\x00"

# this key is generated by the function 0089EB79 derived from another key (11 d0 fb 40 ...)
set MEMORY_FILE3  binary "\x6a\x16\xbe\x0b\xc7\x9d\xe7\x00\x5b\x19\xe9\x46\xaa\x93\x49\xe3\xcf\xde\x4c\xfb\x02\x1a\x1f\x28\xa6\xd5\x4c\xa4\x72\x67\x05\x17\x14\x01\xb7\x0f\x13\x03\x5d\x52\xd3\xb8\xf3\xb5\x07\x8a\xbe\xdb\xa8\x3e\x46\x2e\xaa\xb9\xee\x27\xed\x03\x44\xdf\x14\x5c\xdd\x22\x98\xd4\x16\x93\x23\x26\xed\x96\x18\x90\x60\x6e\x92\x4b\x5f\x3a\xcb\x11\x9c\x76\x9b\x0c\x11\x09\xb8\xc8\x11\x49\xbb\xe5\x68\x4e\xd2\x64\x05\xbf\x2f\x88\x2a\xdf"

math CHUNK_SIZE = 0x00010000
goto -0x2c
get SIZE long
get SIZE long   # same
get OFFSET long
get INFO_OFF long
get FILES long
get PAK_SIZE long
getdstring DUMMY 0x10
get DUMMY long

log MEMORY_FILE OFFSET SIZE
for x = 0 < SIZE
    goto x MEMORY_FILE
    calldll MEMORY_FILE10 0 stdcall RET MEMORY_FILE MEMORY_FILE MEMORY_FILE3
next x + 8

goto INFO_OFF MEMORY_FILE
for i = 0 < FILES
    get NAME_OFF long MEMORY_FILE
    get OFFSET long MEMORY_FILE
    get SIZE long MEMORY_FILE
    get FLAGS long MEMORY_FILE  # 0x13

    savepos TMP MEMORY_FILE
    goto NAME_OFF MEMORY_FILE
    get NAME string MEMORY_FILE
    goto TMP MEMORY_FILE

    xmath CHUNKS "SIZE / CHUNK_SIZE"
    if SIZE % CHUNK_SIZE
        math CHUNKS + 1
    endif

    log NAME 0 0
    append
    xmath TMP "OFFSET - (CHUNKS * 4)"
    goto TMP
    for x = 0 < CHUNKS
        get CHUNK_ZSIZE long
        filexor 0x44
        if CHUNK_ZSIZE & 0x80000000
            math CHUNK_ZSIZE & 0x7fffffff
            log NAME OFFSET CHUNK_ZSIZE
        else
            clog NAME OFFSET CHUNK_ZSIZE CHUNK_SIZE
        endif
        filexor ""
        math OFFSET + CHUNK_ZSIZE
    next x
    append
next i
